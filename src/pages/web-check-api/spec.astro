---
// 导入基础布局组件
import BaseLayout from '@layouts/Base.astro';
// 导入导航栏组件
import NavBar from '@components/scafold/Nav.astro';
// 导入页脚组件
import Footer from '@components/scafold/Footer.astro';
---

<!-- 渲染基础布局组件 -->
<!-- title：页面标题 -->
<!-- description：页面描述（用于 SEO） -->
<BaseLayout
  title="API Docs | Web Check"
  description="API documentation for the Web Check backend REST endpoints"
>
  <!-- 在头部插槽中插入外部样式表 -->
  <Fragment slot="head">
    <!-- Swagger UI 样式表（用于渲染 API 文档） -->
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/swagger-ui/4.1.3/swagger-ui.css">
    <!-- Swagger UI 深色主题样式表 -->
    <link rel="stylesheet" href="https://rawcdn.githack.com/Amoenus/SwaggerDark/2064ccd45b571865a64c731fa6bfddfbf2a01fe1/SwaggerDark.css">
  </Fragment>
  
  <!-- 主内容区域 -->
  <main>
    <!-- 导航栏 -->
    <NavBar />
    <!-- Swagger UI 容器（用于渲染 API 文档） -->
    <div id="swagger-ui"></div>
    <!-- 页脚 -->
    <Footer />
  </main>
</BaseLayout>

<!-- ==================== 外部脚本 ==================== -->
<!-- Swagger UI 核心脚本（用于渲染 API 文档） -->
<!-- is:inline：将脚本内联到 HTML 中（不打包） -->
<script is:inline src="https://cdnjs.cloudflare.com/ajax/libs/swagger-ui/4.1.3/swagger-ui-bundle.js"></script>

<!-- ==================== 客户端脚本 ==================== -->
<script is:inline>
  // 初始化 Swagger UI 的函数
  function initializeSwagger() {
    // 调用 SwaggerUIBundle 构造函数，初始化 Swagger UI
    SwaggerUIBundle({
      url: '/resources/openapi-spec.yml',  // OpenAPI 规范文件的 URL
      dom_id: '#swagger-ui',  // 渲染容器的 DOM 元素 ID
      deepLinking: true,  // 启用深度链接（允许直接链接到特定的 API 端点）
      presets: [  // 预设配置
        SwaggerUIBundle.presets.apis,  // API 预设
        SwaggerUIBundle.SwaggerUIStandalonePreset  // 独立页面预设
      ],
    });
  }
  
  // 直接访问页面时初始化 Swagger UI（监听 DOMContentLoaded 事件）
  document.addEventListener('DOMContentLoaded', initializeSwagger);
  
  // 从其他页面导航到此页面时初始化 Swagger UI（检查文档就绪状态）
  if (document.readyState === 'complete' || document.readyState === 'interactive') {
    initializeSwagger();
  }
</script>

<!-- ==================== 样式定义 ==================== -->
<style lang="scss">
  // 导入全局样式
  @import '@styles/global.scss';
  
  // 主内容区域样式
  main {
    height: 100vh;  // 高度为视口高度的 100%
    padding-top: 2rem;  // 顶部内边距
    
    // Swagger UI 容器样式
    #swagger-ui {
      margin: 0 auto;  // 水平居中
      width: calc(100vw - 4rem);  // 宽度为视口宽度减去 4rem（左右各 2rem）
      max-width: 1600px;  // 最大宽度
      min-height: 100vh;  // 最小高度为视口高度的 100%
    }
  }
</style>
